"use strict";(self.webpackChunkactivejdocs=self.webpackChunkactivejdocs||[]).push([[8176],{4387:(e,r,t)=>{t.r(r),t.d(r,{assets:()=>d,contentTitle:()=>m,default:()=>h,frontMatter:()=>l,metadata:()=>c,toc:()=>p});var n=t(5893),a=t(1151),s=t(7618),i=t(4304),o=t(7815);const l={title:"ActiveJ | Datastream, asynchronous reactive Java streams with minimal overhead",description:"Asynchronous reactive Java streams with extremely low overhead",sidebar_label:"Datastream",keywords:["datastream","reactive streams","async reactive streams","java","java framework"]},m="Datastream",c={id:"async-io/datastream",title:"ActiveJ | Datastream, asynchronous reactive Java streams with minimal overhead",description:"Asynchronous reactive Java streams with extremely low overhead",source:"@site/docs/async-io/datastream.mdx",sourceDirName:"async-io",slug:"/async-io/datastream",permalink:"/async-io/datastream",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"ActiveJ | Datastream, asynchronous reactive Java streams with minimal overhead",description:"Asynchronous reactive Java streams with extremely low overhead",sidebar_label:"Datastream",keywords:["datastream","reactive streams","async reactive streams","java","java framework"]},sidebar:"docs",previous:{title:"CSP",permalink:"/async-io/csp"},next:{title:"Net",permalink:"/async-io/net"}},d={},p=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Comparison to CSP",id:"comparison-to-csp",level:2},{value:"Benchmarks",id:"benchmarks",level:2},{value:"Examples",id:"examples",level:2},{value:"Simple Supplier",id:"simple-supplier",level:3},{value:"Simple Consumer",id:"simple-consumer",level:3},{value:"Custom Transformer",id:"custom-transformer",level:3},{value:"Built-in Stream Nodes",id:"built-in-stream-nodes",level:3}];function u(e){const r={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.h1,{id:"datastream",children:"Datastream"}),"\n",(0,n.jsx)(r.h2,{id:"overview",children:"Overview"}),"\n",(0,n.jsx)(r.p,{children:"Datastream is a high-performance implementation of reactive streams. It is useful for intra and inter-server\ncommunication and asynchronous data processing."}),"\n",(0,n.jsx)(r.h2,{id:"features",children:"Features"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsx)(r.li,{children:"Modern implementation of asynchronous reactive streams (as opposed to streams in Java 8 and traditional thread-based blocking streams)"}),"\n",(0,n.jsx)(r.li,{children:"Asynchronous with effective backpressure control to cope with the natural imbalance in the speed of data sources"}),"\n",(0,n.jsx)(r.li,{children:"Composable stream operations (mappers, reducers, filters, sorters, mergers/splitters, compression, serialization)"}),"\n",(0,n.jsxs)(r.li,{children:["Stream-based network and file I/O on top of reactors (",(0,n.jsx)(r.a,{href:"/async-io/eventloop",children:"Eventloop module"}),")"]}),"\n",(0,n.jsxs)(r.li,{children:["Compatibility with ",(0,n.jsx)(r.a,{href:"/async-io/csp",children:"CSP module"})]}),"\n"]}),"\n",(0,n.jsx)(r.h2,{id:"comparison-to-csp",children:"Comparison to CSP"}),"\n",(0,n.jsx)(r.p,{children:"Datastream has a lot in common with the CSP module.\nAlthough they were both designed for I/O processing, there are few important differecnes:"}),"\n",(0,n.jsxs)(r.table,{children:[(0,n.jsx)(r.thead,{children:(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.th,{}),(0,n.jsx)(r.th,{children:"Datastream"}),(0,n.jsx)(r.th,{children:"CSP"})]})}),(0,n.jsxs)(r.tbody,{children:[(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.strong,{children:"Overhead:"})}),(0,n.jsx)(r.td,{children:"Low: stream can be started with 1 virtual call, short-circuit evaluation optimizes performance"}),(0,n.jsx)(r.td,{children:"No short-circuit evaluation, overhead is higher"})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.strong,{children:"Throughput speed:"})}),(0,n.jsxs)(r.td,{children:["Very fast (",(0,n.jsx)(r.em,{children:"360 880 548 ops/sec"}),")"]}),(0,n.jsxs)(r.td,{children:["Fast (",(0,n.jsx)(r.em,{children:"105 932 203 ops/sec"}),"), but slower than Datastream"]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.strong,{children:"Optimized for:"})}),(0,n.jsx)(r.td,{children:"Small pieces of data"}),(0,n.jsxs)(r.td,{children:["Medium-sized objects, ",(0,n.jsx)(r.a,{href:"/misc/bytebuf",children:(0,n.jsx)(r.code,{children:"ByteBufs"})})]})]}),(0,n.jsxs)(r.tr,{children:[(0,n.jsx)(r.td,{children:(0,n.jsx)(r.strong,{children:"Programming model:"})}),(0,n.jsx)(r.td,{children:"More complicated"}),(0,n.jsx)(r.td,{children:"Simple and convenient"})]})]})]}),"\n",(0,n.jsxs)(r.p,{children:["ActiveJ makes extensive use of combinations of CSP and Datastream for maximum efficiency. To do this,\n",(0,n.jsx)(r.code,{children:"ChannelSupplier"}),", ",(0,n.jsx)(r.code,{children:"ChannelConsumer"}),", ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/supplier/StreamSupplier.java",children:(0,n.jsx)(r.code,{children:"StreamSupplier"})}),"\nand ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/supplier/StreamConsumer.java",children:(0,n.jsx)(r.code,{children:"StreamConsumer"})})," have ",(0,n.jsx)(r.code,{children:"transformWith()"})," methods and special\nTransformer interfaces. Using these methods and interfaces, you can easily transform channels into other channels or datastreams and vice versa, creating chains of such transformations."]}),"\n",(0,n.jsx)(r.h2,{id:"benchmarks",children:"Benchmarks"}),"\n",(0,n.jsxs)(r.p,{children:["We measured the performance of Datastream (",(0,n.jsx)(r.code,{children:"StreamSupplier"})," streams 100M Integer objects to ",(0,n.jsx)(r.code,{children:"StreamConsumer"})," scenario)\nand got the following result:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"Time: 2771ms; Average time: 277.1ms; Best time: 275ms; Worst time: 281ms; Operations per second: 360 880 548\n"})}),"\n",(0,n.jsxs)(r.p,{children:["We also measured the performance of the TCP server that uses both Datastream and CSP and got an average result of ",(0,n.jsx)(r.strong,{children:"47 495 905 requests per second"}),"."]}),"\n",(0,n.jsxs)(r.p,{children:["You can find benchmark sources on ",(0,n.jsx)(s.Z,{url:"/benchmarks/datastream/src/main/java/io/activej/datastream/DatastreamBenchmark.java",children:(0,n.jsx)(r.strong,{children:"GitHub"})})]}),"\n",(0,n.jsx)(r.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsxs)(r.ul,{children:["\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#simple-supplier",children:"Simple Supplier"})," - shows how to create a simple ",(0,n.jsx)(r.code,{children:"StreamSupplier"})," and stream some data to ",(0,n.jsx)(r.code,{children:"StreamConsumer"})]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#simple-consumer",children:"Simple Consumer"})," - shows how to create a simple ",(0,n.jsx)(r.code,{children:"StreamConsumer"})]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#custom-transformer",children:"Custom Transformer"})," - shows how to create a custom ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/processor/StreamTransformer.java",children:(0,n.jsx)(r.code,{children:"StreamTransformer"})}),", which takes strings and transforms them to their length if it is less than ",(0,n.jsx)(r.code,{children:"MAX_LENGTH"}),"."]}),"\n",(0,n.jsxs)(r.li,{children:[(0,n.jsx)(r.a,{href:"#built-in-stream-nodes",children:"Built-in Stream Nodes Example"})," - demonstrates some of Datastream's built-in features, such as filtering, splitting, union, and mapping."]}),"\n"]}),"\n",(0,n.jsxs)(r.admonition,{type:"note",children:[(0,n.jsx)(r.p,{children:"To run the examples, you need to clone ActiveJ from GitHub"}),(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-shell",children:"git clone https://github.com/hoangtien2k3/reactify-core\n"})}),(0,n.jsxs)(r.p,{children:["And import it as a Maven project. Check out tag ",(0,n.jsx)(r.strong,{children:(0,n.jsx)(o.Z,{name:"currentVersion"})}),". Before running the examples, build the project.\nThese examples are located at ",(0,n.jsx)(r.code,{children:"activej/examples/core/datastream"})]})]}),"\n",(0,n.jsx)(r.h3,{id:"simple-supplier",children:"Simple Supplier"}),"\n",(0,n.jsxs)(r.p,{children:["When you run ",(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/SupplierExample.java",children:(0,n.jsx)(r.code,{children:"SupplierExample"})}),", you'll see the following output:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"Consumer received: [0, 1, 2, 3, 4]\n"})}),"\n",(0,n.jsxs)(r.p,{children:["This output represents the data that our custom ",(0,n.jsx)(r.code,{children:"StreamSupplier"})," provided to ",(0,n.jsx)(r.code,{children:"StreamConsumer"}),". Let's take a\nlook at the implementation:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/SupplierExample.java tag=EXAMPLE",children:'public final class SupplierExample {\n  public static void main(String[] args) {\n\n    //create an eventloop for streams operations\n    Eventloop eventloop = Eventloop.builder()\n      .withCurrentThread()\n      .build();\n    //create a supplier of some numbers\n    StreamSupplier<Integer> supplier = StreamSuppliers.ofValues(0, 1, 2, 3, 4);\n    //creating a consumer for our supplier\n    ToListStreamConsumer<Integer> consumer = ToListStreamConsumer.create();\n\n    //streaming supplier\'s numbers to consumer\n    supplier.streamTo(consumer);\n\n    //when stream completes, streamed data is printed out\n    consumer.getResult().whenResult(result -> System.out.println("Consumer received: " + result));\n\n    //start eventloop\n    eventloop.run();\n  }\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/SupplierExample.java",children:"See full example on GitHub"})})}),"\n",(0,n.jsx)(r.h3,{id:"simple-consumer",children:"Simple Consumer"}),"\n",(0,n.jsxs)(r.p,{children:["When you run ",(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/ConsumerExample.java",children:(0,n.jsx)(r.code,{children:"ConsumerExample"})}),", you'll see the following output:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-bash",children:"received: 1\nreceived: 2\nreceived: 3\nEnd of stream received\n"})}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.code,{children:"ConsumerExample"})," represents a custom consumer that extends ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/AbstractStreamConsumer.java",children:(0,n.jsx)(r.code,{children:"AbstractStreamConsumer"})})," and simply prints the received data. The stream process is managed by the overridden ",(0,n.jsx)(r.code,{children:"onStarted()"}),", ",(0,n.jsx)(r.code,{children:"onEndOfStream()"})," and ",(0,n.jsx)(r.code,{children:"onError()"})," methods:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/ConsumerExample.java tag=EXAMPLE",children:'public final class ConsumerExample<T> extends AbstractStreamConsumer<T> {\n  @Override\n  protected void onStarted() {\n    resume(x -> System.out.println("received: " + x));\n  }\n\n  @Override\n  protected void onEndOfStream() {\n    System.out.println("End of stream received");\n    acknowledge();\n  }\n\n  @Override\n  protected void onError(Exception t) {\n    System.out.println("Error handling logic must be here. No confirmation to upstream is needed");\n  }\n'})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/ConsumerExample.java",children:"See full example on GitHub"})})}),"\n",(0,n.jsx)(r.h3,{id:"custom-transformer",children:"Custom Transformer"}),"\n",(0,n.jsxs)(r.p,{children:["The ",(0,n.jsx)(r.a,{href:"#",children:(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/TransformerExample.java",children:(0,n.jsx)(r.code,{children:"Transformer Example"})})})," shows how to create a custom ",(0,n.jsx)(r.code,{children:"StreamTransformer"})," that takes strings from the input stream and transforms them to their length, if it is less than the given ",(0,n.jsx)(r.code,{children:"MAX_LENGTH"}),". First, we define ",(0,n.jsx)(r.code,{children:"AbstractStreamConsumer"})," and ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/AbstractStreamSupplier.java",children:(0,n.jsx)(r.code,{children:"AbstractStreamSupplier"})}),":"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/TransformerExample.java tag=REGION_1",children:"private final AbstractStreamConsumer<String> input = new AbstractStreamConsumer<>() {\n  @Override\n  protected void onEndOfStream() {\n    output.sendEndOfStream();\n  }\n};\n\nprivate final AbstractStreamSupplier<Integer> output = new AbstractStreamSupplier<>() {\n  @Override\n  protected void onResumed() {\n    input.resume(item -> {\n      int len = item.length();\n      if (len < MAX_LENGTH) {\n        output.send(len);\n      }\n    });\n  }\n\n  @Override\n  protected void onSuspended() {\n    input.suspend();\n  }\n};\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Now we define the ",(0,n.jsx)(r.code,{children:"main"})," method that creates the test data supplier, an instance of ",(0,n.jsx)(r.code,{children:"TransformerExample"})," and ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/consumer/ToListStreamConsumer.java",children:(0,n.jsx)(r.code,{children:"ToListStreamConsumer"})}),"\nNext, we define the sequence of transformation and output:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/TransformerExample.java tag=REGION_2",children:'public static void main(String[] args) {\n  Eventloop eventloop = Eventloop.builder()\n    .withCurrentThread()\n    .withFatalErrorHandler(rethrow())\n    .build();\n\n  StreamSupplier<String> source = StreamSuppliers.ofValues("testdata", "testdata1", "testdata1000");\n  TransformerExample transformer = new TransformerExample();\n\n  source.transformWith(transformer)\n    .toList()\n    .whenResult(v -> System.out.println(v));\n\n  eventloop.run();\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"If you run the example, you'll receive the following output:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",children:"[8, 9]\n"})}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/TransformerExample.java",children:"See full example on GitHub"})})}),"\n",(0,n.jsx)(r.h3,{id:"built-in-stream-nodes",children:"Built-in Stream Nodes"}),"\n",(0,n.jsxs)(r.p,{children:[(0,n.jsx)(r.a,{href:"#",children:(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/BuiltinNodesExample.java",children:(0,n.jsx)(r.code,{children:"BuiltinStreamNodesExample"})})})," demonstrates some simple examples of utilizing built-in datastream nodes."]}),"\n",(0,n.jsxs)(r.p,{children:["The first of these is ",(0,n.jsx)(r.code,{children:"StreamTransformers#filter"}),".\nIt allows you to apply a function to input data and then stream the result of the function to the destination. In this\nparticular example, stream transformer filters the input numbers and then streams only the odd numbers to the consumer ."]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/BuiltinNodesExample.java tag=REGION_1",children:"private static void filter() {\n  StreamSupplier<Integer> supplier = StreamSuppliers.ofValues(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);\n\n  StreamTransformer<Integer, Integer> filter = StreamTransformers.filter(input -> input % 2 == 1);\n\n  ToListStreamConsumer<Integer> consumer = ToListStreamConsumer.create();\n\n  supplier.transformWith(filter).streamTo(consumer);\n\n  consumer.getResult().whenResult(v -> System.out.println(v));\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["The output for this example is ",(0,n.jsx)(r.code,{children:"[1, 3, 5, 7, 9]"}),", while the graph of streams is pretty simple and looks as follows:"]}),"\n",(0,n.jsx)(i.Z,{chart:"\ngraph TD\n    id1(StreamSuppliers#ofIterator)--\x3eid2(Filter$Input)--\x3eid3([Filter])--\x3eid4(Filter$Output)--\x3eid5(ToListStreamConsumer)\n    style id1 stroke:#3578ep,stroke-width:2px\n    style id2 stroke:#fa383e,stroke-width:2px\n    style id3 stroke:#a4a6a8,stroke-width:2px\n    style id4 stroke:#3578ep,stroke-width:2px\n    style id5 stroke:#fa383e,stroke-width:2px\n"}),"\n",(0,n.jsxs)(r.p,{children:["Another built-in stream node is ",(0,n.jsx)(r.code,{children:"StreamTransformers#mapper"}),"."]}),"\n",(0,n.jsx)(r.p,{children:"It changes each input item according to a given function, for example:"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/BuiltinNodesExample.java tag=REGION_3",children:'private static void mapper() {\n  //creating a supplier of 10 numbers\n  StreamSupplier<Integer> supplier = StreamSuppliers.ofValues(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);\n\n  //creating a mapper for the numbers\n  StreamTransformer<Integer, String> simpleMap = StreamTransformers.mapper(x -> x + " times ten = " + x * 10);\n\n  //creating a consumer which converts received values to list\n  ToListStreamConsumer<String> consumer = ToListStreamConsumer.create();\n\n  //applying the mapper to supplier and streaming the result to consumer\n  supplier.transformWith(simpleMap).streamTo(consumer);\n\n  //when consumer completes receiving values, the result is printed out\n  consumer.getResult().whenResult(v -> System.out.println(v));\n}\n'})}),"\n",(0,n.jsx)(r.p,{children:"The output for this example is"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"[\n    1 times ten = 10,\n    2 times ten = 20,\n    3 times ten = 30,\n    4 times ten = 40,\n    5 times ten = 50,\n    6 times ten = 60,\n    7 times ten = 70,\n    8 times ten = 80,\n    9 times ten = 90,\n    10 times ten = 100\n]\n"})}),"\n",(0,n.jsx)(r.p,{children:"and the graph of streams looks as follows:"}),"\n",(0,n.jsx)(i.Z,{chart:"\ngraph TD\n    id1(StreamSuppliers#ofIterator)--\x3eid2(Mapper$Input)--\x3eid3([Mapper])--\x3eid4(Mapper$Output)--\x3eid5(ToListStreamConsumer)\n    style id1 stroke:#3578ep,stroke-width:2px\n    style id2 stroke:#fa383e,stroke-width:2px\n    style id3 stroke:#a4a6a8,stroke-width:2px\n    style id4 stroke:#3578ep,stroke-width:2px\n    style id5 stroke:#fa383e,stroke-width:2px\n"}),"\n",(0,n.jsxs)(r.p,{children:["Let's take a look at another built-in node ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/processor/StreamSplitter.java",children:(0,n.jsx)(r.code,{children:"StreamSplitter"})})]}),"\n",(0,n.jsx)(r.p,{children:"This is a stream transformer that distributes input streams according to a given function. In this example it\ndistributes 10 numbers between 3 consumers."}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/BuiltinNodesExample.java tag=REGION_2",children:'private static void splitter() {\n  StreamSupplier<Integer> supplier = StreamSuppliers.ofValues(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);\n\n  ToIntFunction<Object> hashSharder = item -> (item.hashCode() & Integer.MAX_VALUE) % 3;\n  //creating a sharder of three parts for three consumers\n  StreamSplitter<Integer, Integer> sharder = StreamSplitter.create(\n    (item, acceptors) -> acceptors[hashSharder.applyAsInt(item)].accept(item));\n\n  ToListStreamConsumer<Integer> first = ToListStreamConsumer.create();\n  ToListStreamConsumer<Integer> second = ToListStreamConsumer.create();\n  ToListStreamConsumer<Integer> third = ToListStreamConsumer.create();\n\n  sharder.newOutput().streamTo(first);\n  sharder.newOutput().streamTo(second);\n  sharder.newOutput().streamTo(third);\n\n  supplier.streamTo(sharder.getInput());\n\n  first.getResult().whenResult(x -> System.out.println("first: " + x));\n  second.getResult().whenResult(x -> System.out.println("second: " + x));\n  third.getResult().whenResult(x -> System.out.println("third: " + x));\n}\n'})}),"\n",(0,n.jsx)(r.admonition,{type:"note",children:(0,n.jsxs)(r.p,{children:["In this example we can't use a shortcut method ",(0,n.jsx)(r.code,{children:"transformWith"})," as it can be\nused only with the transformers that have exactly one input and one output streams."]})}),"\n",(0,n.jsx)(r.p,{children:"The output for this example is"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{children:"first: [3, 6, 9]\nsecond: [1, 4, 7, 10]\nthird: [2, 5, 8]`\n"})}),"\n",(0,n.jsx)(r.p,{children:"And the streams graph looks as follows:"}),"\n",(0,n.jsx)(i.Z,{chart:"\ngraph TD;\n    id7(StreamSuppliers#ofIterator):::blue--\x3eid8(StreamSplitter$Input);\n    id8--\x3eStreamSplitter:::grey;\n    StreamSplitter--\x3eid1(StreamSplitter$Output);\n    StreamSplitter--\x3eid2(StreamSplitter$Output);\n    StreamSplitter--\x3eid3(StreamSplitter$Output);\n    id1--\x3eid4(ToListStreamConsumer);\n    id2--\x3eid5(ToListStreamConsumer);\n    id3--\x3eid6(ToListStreamConsumer);\n"}),"\n",(0,n.jsxs)(r.p,{children:["When creating a ",(0,n.jsx)(r.strong,{children:"StreamSplitter"}),", you can specify any function in the lambda. For\nexample, to create a transformer that sends all input data to all consumers, just create the following lambda expression:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",children:"(item, acceptors) -> {for (StreamDataAcceptor<Integer> acceptor : acceptors) { acceptor.accept(item);}}\n"})}),"\n",(0,n.jsx)(r.p,{children:"In this case the output will be"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",children:"first: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nsecond: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nthird: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n"})}),"\n",(0,n.jsxs)(r.p,{children:["Finally, let's take a look at ",(0,n.jsx)(s.Z,{url:"/core-datastream/src/main/java/io/activej/datastream/processor/StreamUnion.java",children:(0,n.jsx)(r.code,{children:"StreamUnion"})})," It works as the opposite of ",(0,n.jsx)(r.code,{children:"StreamSplitter"})," and combines several input streams into one output:"]}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-java",metastring:"url=/examples/core/datastream/src/main/java/BuiltinNodesExample.java tag=REGION_4",children:"private static void union() {\n  //creating three suppliers of numbers\n  StreamSupplier<Integer> source0 = StreamSuppliers.ofValues(1, 2);\n  StreamSupplier<Integer> source1 = StreamSuppliers.empty();\n  StreamSupplier<Integer> source2 = StreamSuppliers.ofValues(3, 4, 5);\n\n  //creating a unifying transformer\n  StreamUnion<Integer> streamUnion = StreamUnion.create();\n\n  //creating a consumer which converts received values to list\n  ToListStreamConsumer<Integer> consumer = ToListStreamConsumer.create();\n\n  //stream the sources into new inputs of the unifier\n  source0.streamTo(streamUnion.newInput());\n  source1.streamTo(streamUnion.newInput());\n  source2.streamTo(streamUnion.newInput());\n\n  //and stream the output of the unifier into the consumer\n  streamUnion.getOutput().streamTo(consumer);\n\n  //when consumer completes receiving values, the result is printed out\n  consumer.getResult().whenResult(v -> System.out.println(v));\n}\n"})}),"\n",(0,n.jsxs)(r.p,{children:["The output for this example is ",(0,n.jsx)(r.code,{children:"[1, 2, 3, 4, 5]"})," and the graph of streams looks as follows:"]}),"\n",(0,n.jsx)(i.Z,{chart:"\ngraph TD;\n    id1(StreamSuppliers#ofIterator)--\x3eid2(StreamUnion$Input);\n    id3(StreamSuppliers#ofIterator)--\x3eid4(StreamUnion$Input);\n    id5(StreamSuppliers#ofIterator)--\x3eid6(StreamUnion$Input);\n    id2--\x3eStreamUnion;\n    id4--\x3eStreamUnion;\n    id6--\x3eStreamUnion;\n    StreamUnion--\x3eStreamUnion$Output;\n    StreamUnion$Output--\x3eStreamConsumer;\n    StreamUnion$Output--\x3eToListStreamConsumer;\n"}),"\n",(0,n.jsx)(r.p,{children:(0,n.jsx)(r.strong,{children:(0,n.jsx)(s.Z,{url:"/examples/core/datastream/src/main/java/BuiltinNodesExample.java",children:"See full example on GitHub"})})})]})}function h(e={}){const{wrapper:r}={...(0,a.a)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(u,{...e})}):u(e)}},7618:(e,r,t)=>{t.d(r,{Z:()=>s});t(7294);var n=t(9962),a=t(5893);const s=e=>{let{url:r,text:t,isInline:s=!0,children:i}=e;const{siteConfig:o}=(0,n.Z)(),l=r.startsWith("/examples")?o.customFields.githubExamplesBranch:o.customFields.githubBranch;return(0,a.jsx)("a",{style:s?{}:{display:"block",marginBottom:"16px"},href:o.customFields.githubUrl+"/"+l+r,target:"_blank",children:t||i})}},4304:(e,r,t)=>{t.d(r,{Z:()=>i});var n=t(7294),a=t(6365),s=t(5893);a.L.initialize({startOnLoad:!0});const i=e=>{let{chart:r}=e;return(0,n.useEffect)((()=>{a.L.contentLoaded()}),[]),(0,s.jsx)("div",{className:"mermaid",children:r})}},7815:(e,r,t)=>{t.d(r,{Z:()=>a});t(7294);var n=t(9962);const a=e=>{let{name:r}=e;const{siteConfig:t}=(0,n.Z)();if(!r)throw new Error("Variable name is required");if(void 0===t.customFields[r])throw new Error(`Variable ${r} not exist`);return t.customFields[r]}}}]);